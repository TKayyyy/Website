<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCAI Survey - Khảo sát Văn hóa Tổ chức</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .info-section {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-item label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }

        .info-item input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .info-item input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .instructions {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #2196f3;
        }

        .instructions h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .instructions p {
            margin-bottom: 10px;
            color: #555;
        }

        .section {
            margin-bottom: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .section:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .section-header {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-bottom: 2px solid #ddd;
        }

        .section-header h2 {
            color: #2c3e50;
            font-size: 1.4em;
        }

        .section-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .section-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .section-table th:first-child {
            width: 80px;
        }

        .section-table th:nth-child(3),
        .section-table th:nth-child(4) {
            width: 100px;
        }

        .section-table td {
            padding: 15px;
            border: 1px solid #ddd;
            vertical-align: top;
        }

        .section-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .section-table tr:hover {
            background-color: #f0f8ff;
        }

        .question-code {
            font-weight: bold;
            color: #667eea;
            text-align: center;
            font-size: 1.1em;
        }

        .question-text {
            line-height: 1.6;
            color: #444;
        }

        .score-input {
            width: 60px;
            padding: 8px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .score-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .total-row {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            font-weight: bold;
            font-size: 1.1em;
        }

        .total-valid {
            color: #28a745;
        }

        .total-invalid {
            color: #dc3545;
        }

        .summary-section {
            background: linear-gradient(135deg, #fff9e6 0%, #ffecb3 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            border: 2px solid #ffc107;
        }

        .summary-section h3 {
            color: #e65100;
            margin-bottom: 20px;
            font-size: 1.5em;
            text-align: center;
        }

        .culture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .culture-card {
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.2s;
            border: 2px solid transparent;
        }

        .culture-card:hover {
            transform: translateY(-3px);
            border-color: #667eea;
        }

        .culture-clan {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            color: #1976d2;
        }

        .culture-adhocracy {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            color: #2e7d32;
        }

        .culture-market {
            background: linear-gradient(135deg, #fff3e0 0%, #ffcc80 100%);
            color: #ef6c00;
        }

        .culture-hierarchy {
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
            color: #c2185b;
        }

        .culture-card h4 {
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .culture-scores {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .culture-scores span {
            font-weight: bold;
            font-size: 1.1em;
        }

        .button-group {
            display: flex;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 200px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            justify-content: center;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(86, 171, 47, 0.4);
        }

        .btn-disabled {
            background: #cccccc;
            color: #666;
            cursor: not-allowed;
        }

        .btn-disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .alert {
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid #ffc107;
        }

        .alert-warning {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            color: #856404;
        }

        .alert-success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            border-left-color: #28a745;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .section-table th,
            .section-table td {
                padding: 10px 8px;
                font-size: 14px;
            }

            .score-input {
                width: 50px;
                font-size: 14px;
            }

            .culture-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                min-width: auto;
            }
        }

        .introduction-section {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    padding: 25px;
    border-radius: 10px;
    margin-bottom: 30px;
    border-left: 5px solid #28a745;
}

.introduction-section h3 {
    color: #155724;
    margin-bottom: 15px;
    font-size: 1.3em;
}

.introduction-section ul {
    margin: 15px 0;
    padding-left: 20px;
}

.introduction-section li {
    margin-bottom: 8px;
    line-height: 1.5;
}

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            line-height: 1.6;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h3 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .highlight {
            background-color: #e8f4f8;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 15px 0;
        }
        .time-info {
            background-color: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        .thank-you {
            background-color: #d4edda;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #28a745;
            margin-top: 20px;
            font-style: italic;
        }

        ul {
            margin: 10px 0;
        }
        li {
            margin: 8px 0;
        }
        .bold {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>KHẢO SÁT VĂN HÓA TỔ CHỨC</h1>
            <p>Organizational Culture Assessment Instrument (OCAI)</p>
        </div>


<div class="container">
        <h3>📋 Giới thiệu về khảo sát OCAI - Văn hóa Tổ chức</h3>
        
        <p>Chúng em là sinh viên lớp K30 ngành Quan hệ công chúng, hiện đang học lớp Văn hoá Doanh nghiệp - 243_71CULT30302_07.</p>
        
        <div class="highlight">
            <p><strong>🎯 Mục đích khảo sát:</strong> Đây là bài tập khảo sát về văn hoá doanh nghiệp sử dụng công cụ OCAI (Organizational Culture Assessment Instrument), với đối tượng nghiên cứu là <strong>Trường Đại học Văn Lang</strong>. Chúng em mong muốn tìm hiểu sâu hơn về đặc điểm văn hóa tổ chức trong môi trường giáo dục hiện đại.</p>
        </div>

        <div class="time-info">
            <p><strong>⏰ Thời gian thực hiện:</strong> Khoảng 10 phút</p>
        </div>

        <p><strong>👥 Đối tượng khảo sát:</strong></p>
        <ul>
            <li>Quý Thầy/Cô Giảng viên của Trường Đại học Văn Lang</li>
            <li>Anh/Chị Cán bộ, Nhân viên của Trường</li>
            <li>Sinh viên đang học tại Trường</li>
        </ul>

        <p><strong>🔒 Cam kết bảo mật:</strong></p>
        <ul>
            <li>Khảo sát này hoàn toàn ẩn danh và chỉ phục vụ mục đích học thuật</li>
            <li>Thông tin thu thập sẽ được bảo mật và không được lan truyền hay sử dụng sai mục đích</li>
            <li>Kết quả chỉ được sử dụng cho bài tập môn học</li>
        </ul>
        <div class="thank-you">
            <p><strong>🙏 Chúng em xin chân thành cảm ơn!</strong></p>
            <p>Rất mong Quý Thầy/Cô Giảng viên và Anh/Chị Cán bộ, Nhân viên của Trường dành chút thời gian quý báu để giúp chúng em hoàn thành khảo sát này.</p>
        </div>
    </div>

</div>
        <div class="info-section">
            <h3>Thông tin người tham gia</h3>
            <div class="info-grid">
                <div class="info-item">
                    <label>Họ và tên:</label>
                    <input type="text" id="participantName" placeholder="Nhập họ và tên" onchange="updateButtons()">
                </div>
                <div class="info-item">
                    <label>Phòng ban:</label>
                    <input type="text" id="participantDepartment" placeholder="Nhập phòng ban">
                </div>
                <div class="info-item">
                    <label>Chức vụ:</label>
                    <input type="text" id="participantPosition" placeholder="Nhập chức vụ">
                </div>
                <div class="info-item">
                    <label>Ngày khảo sát:</label>
                    <input type="date" id="surveyDate">
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>🎯 Hướng dẫn </h3>
            <p>Với mỗi nhóm câu hỏi, Thầy/Cô/Anh/Chị hãy <strong>phân bổ 100 điểm</strong> cho 2 mô tả tương ứng, ở hai cột: </p>
            <p> <strong>"Hiện tại"</strong> - phản ảnh thực trạng hiện nay tại tổ chức giáo dục bạn đang làm việc.</p>
            <p><strong>"Mong muốn"</strong> - phản ảnh định hướng bạn mong muốn tổ chức hướng đến trong tương lai.</p>
            <p>Tổng điểm mỗi cột <strong>Hiện tại</strong> hoặc <strong>Mong muốn</strong> luôn <strong>phải bằng 100.</strong></p>
            <p> <strong>❗ Không bắt buộc chia đều.</strong></p>
        </div>

        <div id="surveyContent"></div>

        <div class="summary-section">
            <h3>📊 Tóm tắt điểm số theo loại văn hóa</h3>
            <div class="culture-grid" id="cultureScores"></div>
        </div>

            <button class="btn btn-success" id="completeBtn" onclick="completeSurvey()">
                📤 Gửi khảo sát & Hoàn tất
            </button>

        </div>

        <div id="alertMessage"></div>
    </div>

        <script>
        // Thay thế URL này bằng URL Web App của bạn
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwn_wFZARpVfqYtcWBzcUxFY81XmJb5oMkp_nRPOoAyLe1nWXnzC3XCj7dyEtLgfBfsMg/exec';
        
       
    </script>

    <script>
        const surveyData = [
            {
                id: 'I',
                title: 'I. Những đặc điểm của tổ chức',
                questions: [
                    { code: '1.A', text: 'Tổ chức giống như một gia đình lớn, mọi người thân thiện, hợp tác, gắn bó như đồng nghiệp – người thân.' },
                    { code: '1.B', text: 'Tổ chức là môi trường đổi mới, khuyến khích sáng tạo và các phương pháp dạy học thử nghiệm.' },
                    { code: '1.C', text: 'Tổ chức chú trọng hiệu suất, kết quả giảng dạy, chỉ số học tập và thành tích rõ ràng.' },
                    { code: '1.D', text: 'Tổ chức có hệ thống quản lý chặt chẽ, quy trình vận hành – sư phạm được tuân thủ nghiêm ngặt.' }
                ]
            },
            {
                id: 'II',
                title: 'II. Lãnh đạo tổ chức',
                questions: [
                    { code: '2.A', text: 'Lãnh đạo được coi là người cố vấn, hướng dẫn hoặc là hình mẫu của tổ chức.' },
                    { code: '2.B', text: 'Lãnh đạo được coi là người tiên phong, đổi mới hoặc là người chấp nhận rủi ro.' },
                    { code: '2.C', text: 'Lãnh đạo được coi là người điều phối, nhà tổ chức hoặc là người đạt được hiệu quả.' },
                    { code: '2.D', text: 'Lãnh đạo được coi là người điều hành, quản lý hoặc là người tạo ra sự ổn định.' }
                ]
            },
            {
                id: 'III',
                title: 'III. Quản lý nhân sự',
                questions: [
                    { code: '3.A', text: 'Phong cách quản lý trong tổ chức được đặc trưng bởi làm việc nhóm, sự đồng thuận và tham gia.' },
                    { code: '3.B', text: 'Phong cách quản lý trong tổ chức được đặc trưng bởi cá nhân chấp nhận rủi ro, đổi mới, tự do và sự độc đáo.' },
                    { code: '3.C', text: 'Phong cách quản lý trong tổ chức được đặc trưng bởi cạnh tranh khốc liệt, đòi hỏi cao và thành tích.' },
                    { code: '3.D', text: 'Phong cách quản lý trong tổ chức được đặc trưng bởi sự bảo đảm việc làm, phù hợp, dự đoán được và ổn định trong các mối quan hệ.' }
                ]
            },
            {
                id: 'IV',
                title: 'IV. Sự gắn kết tổ chức',
                questions: [
                    { code: '4.A', text: 'Những gì gắn kết tổ chức lại với nhau là lòng trung thành và tin cậy lẫn nhau. Cam kết với tổ chức rất cao.' },
                    { code: '4.B', text: 'Những gì gắn kết tổ chức lại với nhau là cam kết đổi mới và phát triển. Tính đi đầu về mặt tiêu chuẩn.' },
                    { code: '4.C', text: 'Những gì gắn kết tổ chức lại với nhau là chú trọng thành tích và hoàn thành mục tiêu. Tham vọng và chiến thắng là chủ đề chung.' },
                    { code: '4.D', text: 'Những gì gắn kết tổ chức lại với nhau là các chính sách và quy tắc chính thức. Duy trì hoạt động trôi chảy của tổ chức là quan trọng.' }
                ]
            },
            {
                id: 'V',
                title: 'V. Trọng tâm chiến lược',
                questions: [
                    { code: '5.A', text: 'Tổ chức nhấn mạnh phát triển con người. Sự tin cậy cao, cởi mở và sự tham gia duy trì liên tục.' },
                    { code: '5.B', text: 'Tổ chức nhấn mạnh việc có được các nguồn lực mới và tạo ra những thách thức mới. Thử nghiệm những điều mới và tìm kiếm cơ hội được đánh giá cao.' },
                    { code: '5.C', text: 'Tổ chức nhấn mạnh các hành động cạnh tranh và thành tích. Đạt được mục tiêu khó khăn và thắng lợi trên thị trường là ưu tiên hàng đầu.' },
                    { code: '5.D', text: 'Tổ chức nhấn mạnh tính bền vững và ổn định. Hiệu quả, kiểm soát và hoạt động trôi chảy là quan trọng.' }
                ]
            },
            {
                id: 'VI',
                title: 'VI. Tiêu chí thành công',
                questions: [
                    { code: '6.A', text: 'Tổ chức định nghĩa thành công dựa trên phát triển nguồn nhân lực, làm việc nhóm, cam kết của nhân viên và quan tâm đến con người.' },
                    { code: '6.B', text: 'Tổ chức định nghĩa thành công dựa trên việc có sản phẩm độc đáo hoặc mới nhất. Đó là người dẫn đầu sản phẩm và đổi mới.' },
                    { code: '6.C', text: 'Tổ chức định nghĩa thành công dựa trên thắng lợi trên thị trường và vượt qua đối thủ cạnh tranh. Thị phần cạnh tranh là then chốt.' },
                    { code: '6.D', text: 'Tổ chức định nghĩa thành công dựa trên hiệu quả. Việc phân phối đáng tin cậy, lập kế hoạch trôi chảy và chi phí thấp là các yếu tố quan trọng.' }
                ]
            }
        ];

        let responses = {};

        function initializeSurvey() {
            const content = document.getElementById('surveyContent');
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('surveyDate').value = today;

            surveyData.forEach(section => {
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'section';
                sectionDiv.innerHTML = `
                    <div class="section-header">
                        <h2>${section.title}</h2>
                    </div>
                    <table class="section-table">
                        <thead>
                            <tr>
                                <th>Mã</th>
                                <th>Câu hỏi</th>
                                <th>Hiện tại</th>
                                <th>Mong muốn</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${section.questions.map(question => `
                                <tr>
                                    <td class="question-code">${question.code}</td>
                                    <td class="question-text">${question.text}</td>
                                    <td style="text-align: center;">
                                        <input type="number" class="score-input" 
                                               min="0" max="100" 
                                               id="${section.id}-${question.code}-current"
                                               onchange="updateResponse('${section.id}', '${question.code}', 'current', this.value)">
                                    </td>
                                    <td style="text-align: center;">
                                        <input type="number" class="score-input" 
                                               min="0" max="100" 
                                               id="${section.id}-${question.code}-desired"
                                               onchange="updateResponse('${section.id}', '${question.code}', 'desired', this.value)">
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr class="total-row">
                                <td colspan="2" style="text-align: center; font-weight: bold;">Tổng cộng:</td>
                                <td id="${section.id}-total-current" class="total-invalid" style="text-align: center;">0</td>
                                <td id="${section.id}-total-desired" class="total-invalid" style="text-align: center;">0</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
                content.appendChild(sectionDiv);
            });

            updateCultureScores();
        }

        function updateResponse(sectionId, questionCode, type, value) {
            const key = `${sectionId}-${questionCode}-${type}`;
            responses[key] = parseInt(value) || 0;
            updateTotals();
            updateCultureScores();
            updateButtons();
        }

function updateTotals() {
    surveyData.forEach(section => {
        let currentTotal = 0;
        let desiredTotal = 0;

        section.questions.forEach(question => {
            const currentKey = `${section.id}-${question.code}-current`;
            const desiredKey = `${section.id}-${question.code}-desired`;
            currentTotal += responses[currentKey] || 0;
            desiredTotal += responses[desiredKey] || 0;
        });

        const currentTotalElement = document.getElementById(`${section.id}-total-current`);
        const desiredTotalElement = document.getElementById(`${section.id}-total-desired`);

        currentTotalElement.textContent = currentTotal;
        desiredTotalElement.textContent = desiredTotal;

        currentTotalElement.className = currentTotal === 100 ? 'total-valid' : 'total-invalid';
        desiredTotalElement.className = desiredTotal === 100 ? 'total-valid' : 'total-invalid';

        // 🆕 Hiển thị cảnh báo nếu > 100
        let alertId = `${section.id}-alert`;
        let alertElement = document.getElementById(alertId);
        if (!alertElement) {
            alertElement = document.createElement('div');
            alertElement.id = alertId;
            alertElement.style.marginTop = '10px';
            alertElement.style.fontWeight = 'bold';
            alertElement.style.color = '#dc3545'; // màu đỏ
            currentTotalElement.parentElement.parentElement.appendChild(alertElement);
        }

        if (currentTotal > 100 || desiredTotal > 100) {
            alertElement.textContent = '⚠️ Tổng điểm vượt quá 100. Vui lòng kiểm tra lại.';
        } else {
            alertElement.textContent = '';
        }
    });
}


        function updateCultureScores() {
            const cultureTypes = ['A', 'B', 'C', 'D'];
            const cultureNames = ['Clan (Gia đình)', 'Adhocracy (Đổi mới)', 'Market (Thị trường)', 'Hierarchy (Phân cấp)'];
            const cultureClasses = ['culture-clan', 'culture-adhocracy', 'culture-market', 'culture-hierarchy'];
            
            const scoresDiv = document.getElementById('cultureScores');
            scoresDiv.innerHTML = '';
            
            cultureTypes.forEach((type, index) => {
                let currentTotal = 0;
                let desiredTotal = 0;
                
                surveyData.forEach(section => {
                    const question = section.questions.find(q => q.code.endsWith(type));
                    if (question) {
                        const currentKey = `${section.id}-${question.code}-current`;
                        const desiredKey = `${section.id}-${question.code}-desired`;
                        currentTotal += responses[currentKey] || 0;
                        desiredTotal += responses[desiredKey] || 0;
                    }
                });
                
                const currentAvg = Math.round(currentTotal / surveyData.length * 10) / 10;
                const desiredAvg = Math.round(desiredTotal / surveyData.length * 10) / 10;
                
                const cultureCard = document.createElement('div');
                cultureCard.className = `culture-card ${cultureClasses[index]}`;
                cultureCard.innerHTML = `
                    <h4>${cultureNames[index]}</h4>
                    <div class="culture-scores">
                        <span>Hiện tại: ${currentAvg}</span>
                        <span>Mong muốn: ${desiredAvg}</span>
                    </div>
                `;
                scoresDiv.appendChild(cultureCard);
            });
        }

function updateButtons() {
    const isValid = surveyData.every(section => {
        let currentTotal = 0;
        let desiredTotal = 0;
        
        section.questions.forEach(question => {
            const currentKey = `${section.id}-${question.code}-current`;
            const desiredKey = `${section.id}-${question.code}-desired`;
            currentTotal += responses[currentKey] || 0;
            desiredTotal += responses[desiredKey] || 0;
        });
        
        return currentTotal === 100 && desiredTotal === 100;
    });

    const name = document.getElementById('participantName').value;
    const canComplete = isValid && name.trim() !== '';
    
    // XÓA PHẦN NÀY
    // const exportBtn = document.getElementById('exportBtn');
    // exportBtn.disabled = !canExport;
    // exportBtn.className = canExport ? 'btn btn-success' : 'btn btn-disabled';
    
    const completeBtn = document.getElementById('completeBtn');
    completeBtn.disabled = !canComplete;
    completeBtn.className = canComplete ? 'btn btn-primary' : 'btn btn-disabled';
    
    showAlert(isValid);
}

        function showAlert(isValid) {
            const alertDiv = document.getElementById('alertMessage');
            
            if (isValid) {
                alertDiv.innerHTML = `
                    <div class="alert alert-success">
                        ✅ Khảo sát đã hoàn thành! Tất cả các phần đều có tổng điểm = 100.
                    </div>
                `;
            } else {
                alertDiv.innerHTML = `
                    <div class="alert alert-warning">
                        ⚠️ Vui lòng đảm bảo tổng điểm của mỗi phần = 100 để hoàn thành khảo sát.
                    </div>
                `;
            }
        }

function completeSurvey() {
    // Thêm loading indicator
    const completeBtn = document.getElementById('completeBtn');
    completeBtn.innerHTML = '⏳ Đang gửi...';
    completeBtn.disabled = true;
    
    const participantInfo = {
        name: document.getElementById('participantName').value,
        department: document.getElementById('participantDepartment').value,
        position: document.getElementById('participantPosition').value,
        date: document.getElementById('surveyDate').value
    };

    const cultureTypes = ['A', 'B', 'C', 'D'];
    let cultureScores = {};

    cultureTypes.forEach(type => {
        let currentTotal = 0;
        let desiredTotal = 0;

        surveyData.forEach(section => {
            const question = section.questions.find(q => q.code.endsWith(type));
            if (question) {
                const currentKey = `${section.id}-${question.code}-current`;
                const desiredKey = `${section.id}-${question.code}-desired`;
                currentTotal += responses[currentKey] || 0;
                desiredTotal += responses[desiredKey] || 0;
            }
        });

        cultureScores[`Current_${type}`] = Math.round(currentTotal / surveyData.length * 10) / 10;
        cultureScores[`Desired_${type}`] = Math.round(desiredTotal / surveyData.length * 10) / 10;
    });

    // Debug: Log dữ liệu trước khi gửi
    console.log('Sending data:', {
        participantInfo,
        cultureScores
    });

    const formData = new FormData();
    formData.append('Name', participantInfo.name);
    formData.append('Department', participantInfo.department);
    formData.append('Position', participantInfo.position);
    formData.append('Date', participantInfo.date);

    for (let key in cultureScores) {
        formData.append(key, cultureScores[key]);
    }

    fetch(SCRIPT_URL, {
        method: 'POST',
        body: formData
    })
    .then(res => {
        console.log('Response status:', res.status);
        return res.text();
    })
    .then(data => {
        console.log('Response data:', data);
        alert("✅ Khảo sát đã được gửi thành công!");
        completeBtn.innerHTML = '📤 Đã gửi thành công';
    })
    .catch(error => {
        console.error('Error:', error);
        alert("❌ Lỗi khi gửi khảo sát: " + error.message);
        completeBtn.innerHTML = '📤 Gửi khảo sát & Hoàn tất';
        completeBtn.disabled = false;
    });
}

        // Khởi tạo khảo sát khi trang được load
        document.addEventListener('DOMContentLoaded', function() {
            initializeSurvey();
        });
    </script>
</body>
</html>
