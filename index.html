<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCAI Survey - Kh·∫£o s√°t VƒÉn h√≥a T·ªï ch·ª©c</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .info-section {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-item label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }

        .info-item input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .info-item input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .instructions {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #2196f3;
        }

        .instructions h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .instructions p {
            margin-bottom: 10px;
            color: #555;
        }

        .section {
            margin-bottom: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .section:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .section-header {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-bottom: 2px solid #ddd;
        }

        .section-header h2 {
            color: #2c3e50;
            font-size: 1.4em;
        }

        .section-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .section-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .section-table th:first-child {
            width: 80px;
        }

        .section-table th:nth-child(3),
        .section-table th:nth-child(4) {
            width: 100px;
        }

        .section-table td {
            padding: 15px;
            border: 1px solid #ddd;
            vertical-align: top;
        }

        .section-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .section-table tr:hover {
            background-color: #f0f8ff;
        }

        .question-code {
            font-weight: bold;
            color: #667eea;
            text-align: center;
            font-size: 1.1em;
        }

        .question-text {
            line-height: 1.6;
            color: #444;
        }

        .score-input {
            width: 60px;
            padding: 8px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .score-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .total-row {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            font-weight: bold;
            font-size: 1.1em;
        }

        .total-valid {
            color: #28a745;
        }

        .total-invalid {
            color: #dc3545;
        }

        .summary-section {
            background: linear-gradient(135deg, #fff9e6 0%, #ffecb3 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 40px 0;
            border: 2px solid #ffc107;
        }

        .summary-section h3 {
            color: #e65100;
            margin-bottom: 20px;
            font-size: 1.5em;
            text-align: center;
        }

        .culture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .culture-card {
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.2s;
            border: 2px solid transparent;
        }

        .culture-card:hover {
            transform: translateY(-3px);
            border-color: #667eea;
        }

        .culture-clan {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            color: #1976d2;
        }

        .culture-adhocracy {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            color: #2e7d32;
        }

        .culture-market {
            background: linear-gradient(135deg, #fff3e0 0%, #ffcc80 100%);
            color: #ef6c00;
        }

        .culture-hierarchy {
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
            color: #c2185b;
        }

        .culture-card h4 {
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .culture-scores {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .culture-scores span {
            font-weight: bold;
            font-size: 1.1em;
        }

        .button-group {
            display: flex;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 200px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(86, 171, 47, 0.4);
        }

        .btn-disabled {
            background: #cccccc;
            color: #666;
            cursor: not-allowed;
        }

        .btn-disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .alert {
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid #ffc107;
        }

        .alert-warning {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            color: #856404;
        }

        .alert-success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            border-left-color: #28a745;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .section-table th,
            .section-table td {
                padding: 10px 8px;
                font-size: 14px;
            }

            .score-input {
                width: 50px;
                font-size: 14px;
            }

            .culture-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>KH·∫¢O S√ÅT VƒÇN H√ìA T·ªî CH·ª®C</h1>
            <p>Organizational Culture Assessment Instrument (OCAI)</p>
        </div>

        <div class="info-section">
            <h3>Th√¥ng tin ng∆∞·ªùi tham gia</h3>
            <div class="info-grid">
                <div class="info-item">
                    <label>H·ªç v√† t√™n:</label>
                    <input type="text" id="participantName" placeholder="Nh·∫≠p h·ªç v√† t√™n" onchange="updateButtons()">
                </div>
                <div class="info-item">
                    <label>Ph√≤ng ban:</label>
                    <input type="text" id="participantDepartment" placeholder="Nh·∫≠p ph√≤ng ban">
                </div>
                <div class="info-item">
                    <label>Ch·ª©c v·ª•:</label>
                    <input type="text" id="participantPosition" placeholder="Nh·∫≠p ch·ª©c v·ª•">
                </div>
                <div class="info-item">
                    <label>Ng√†y kh·∫£o s√°t:</label>
                    <input type="date" id="surveyDate">
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>üéØ H∆∞·ªõng d·∫´n th·ª±c hi·ªán</h3>
            <p><strong>B∆∞·ªõc 1:</strong> Ph√¢n b·ªï <strong>100 ƒëi·ªÉm</strong> cho m·ªói nh√≥m c√¢u h·ªèi, chia ƒë·ªÅu cho 4 ƒë√°p √°n A, B, C, D.</p>
            <p><strong>B∆∞·ªõc 2:</strong> <strong>Hi·ªán t·∫°i</strong> - M√¥ t·∫£ t·ªï ch·ª©c hi·ªán t·∫°i c·ªßa b·∫°n | <strong>Mong mu·ªën</strong> - M√¥ t·∫£ t·ªï ch·ª©c l√Ω t∆∞·ªüng b·∫°n mong mu·ªën</p>
            <p><strong>B∆∞·ªõc 3:</strong> ƒê·∫£m b·∫£o t·ªïng ƒëi·ªÉm m·ªói c·ªôt = 100 ƒë·ªÉ ho√†n th√†nh kh·∫£o s√°t</p>
        </div>

        <div id="surveyContent"></div>

        <div class="summary-section">
            <h3>üìä T√≥m t·∫Øt ƒëi·ªÉm s·ªë theo lo·∫°i vƒÉn h√≥a</h3>
            <div class="culture-grid" id="cultureScores"></div>
        </div>

        <div class="button-group">
            <button class="btn btn-success" id="exportBtn" onclick="exportToCSV()">
                üìä Xu·∫•t k·∫øt qu·∫£ ra CSV
            </button>
            <button class="btn btn-primary" id="completeBtn" onclick="completeSurvey()">
                ‚úÖ Ho√†n th√†nh kh·∫£o s√°t
            </button>
        </div>

        <div id="alertMessage"></div>
    </div>

    <script>
        const surveyData = [
            {
                id: 'I',
                title: 'I. Nh·ªØng ƒë·∫∑c ƒëi·ªÉm c·ªßa t·ªï ch·ª©c',
                questions: [
                    { code: '1.A', text: 'T·ªï ch·ª©c gi·ªëng nh∆∞ m·ªôt gia ƒë√¨nh l·ªõn, m·ªçi ng∆∞·ªùi th√¢n thi·ªán, h·ª£p t√°c, g·∫Øn b√≥ nh∆∞ ƒë·ªìng nghi·ªáp ‚Äì ng∆∞·ªùi th√¢n.' },
                    { code: '1.B', text: 'T·ªï ch·ª©c l√† m√¥i tr∆∞·ªùng ƒë·ªïi m·ªõi, khuy·∫øn kh√≠ch s√°ng t·∫°o v√† c√°c ph∆∞∆°ng ph√°p d·∫°y h·ªçc th·ª≠ nghi·ªám.' },
                    { code: '1.C', text: 'T·ªï ch·ª©c ch√∫ tr·ªçng hi·ªáu su·∫•t, k·∫øt qu·∫£ gi·∫£ng d·∫°y, ch·ªâ s·ªë h·ªçc t·∫≠p v√† th√†nh t√≠ch r√µ r√†ng.' },
                    { code: '1.D', text: 'T·ªï ch·ª©c c√≥ h·ªá th·ªëng qu·∫£n l√Ω ch·∫∑t ch·∫Ω, quy tr√¨nh v·∫≠n h√†nh ‚Äì s∆∞ ph·∫°m ƒë∆∞·ª£c tu√¢n th·ªß nghi√™m ng·∫∑t.' }
                ]
            },
            {
                id: 'II',
                title: 'II. L√£nh ƒë·∫°o t·ªï ch·ª©c',
                questions: [
                    { code: '2.A', text: 'L√£nh ƒë·∫°o ƒë∆∞·ª£c coi l√† ng∆∞·ªùi c·ªë v·∫•n, h∆∞·ªõng d·∫´n ho·∫∑c l√† h√¨nh m·∫´u c·ªßa t·ªï ch·ª©c.' },
                    { code: '2.B', text: 'L√£nh ƒë·∫°o ƒë∆∞·ª£c coi l√† ng∆∞·ªùi ti√™n phong, ƒë·ªïi m·ªõi ho·∫∑c l√† ng∆∞·ªùi ch·∫•p nh·∫≠n r·ªßi ro.' },
                    { code: '2.C', text: 'L√£nh ƒë·∫°o ƒë∆∞·ª£c coi l√† ng∆∞·ªùi ƒëi·ªÅu ph·ªëi, nh√† t·ªï ch·ª©c ho·∫∑c l√† ng∆∞·ªùi ƒë·∫°t ƒë∆∞·ª£c hi·ªáu qu·∫£.' },
                    { code: '2.D', text: 'L√£nh ƒë·∫°o ƒë∆∞·ª£c coi l√† ng∆∞·ªùi ƒëi·ªÅu h√†nh, qu·∫£n l√Ω ho·∫∑c l√† ng∆∞·ªùi t·∫°o ra s·ª± ·ªïn ƒë·ªãnh.' }
                ]
            },
            {
                id: 'III',
                title: 'III. Qu·∫£n l√Ω nh√¢n s·ª±',
                questions: [
                    { code: '3.A', text: 'Phong c√°ch qu·∫£n l√Ω trong t·ªï ch·ª©c ƒë∆∞·ª£c ƒë·∫∑c tr∆∞ng b·ªüi l√†m vi·ªác nh√≥m, s·ª± ƒë·ªìng thu·∫≠n v√† tham gia.' },
                    { code: '3.B', text: 'Phong c√°ch qu·∫£n l√Ω trong t·ªï ch·ª©c ƒë∆∞·ª£c ƒë·∫∑c tr∆∞ng b·ªüi c√° nh√¢n ch·∫•p nh·∫≠n r·ªßi ro, ƒë·ªïi m·ªõi, t·ª± do v√† s·ª± ƒë·ªôc ƒë√°o.' },
                    { code: '3.C', text: 'Phong c√°ch qu·∫£n l√Ω trong t·ªï ch·ª©c ƒë∆∞·ª£c ƒë·∫∑c tr∆∞ng b·ªüi c·∫°nh tranh kh·ªëc li·ªát, ƒë√≤i h·ªèi cao v√† th√†nh t√≠ch.' },
                    { code: '3.D', text: 'Phong c√°ch qu·∫£n l√Ω trong t·ªï ch·ª©c ƒë∆∞·ª£c ƒë·∫∑c tr∆∞ng b·ªüi s·ª± b·∫£o ƒë·∫£m vi·ªác l√†m, ph√π h·ª£p, d·ª± ƒëo√°n ƒë∆∞·ª£c v√† ·ªïn ƒë·ªãnh trong c√°c m·ªëi quan h·ªá.' }
                ]
            },
            {
                id: 'IV',
                title: 'IV. S·ª± g·∫Øn k·∫øt t·ªï ch·ª©c',
                questions: [
                    { code: '4.A', text: 'Nh·ªØng g√¨ g·∫Øn k·∫øt t·ªï ch·ª©c l·∫°i v·ªõi nhau l√† l√≤ng trung th√†nh v√† tin c·∫≠y l·∫´n nhau. Cam k·∫øt v·ªõi t·ªï ch·ª©c r·∫•t cao.' },
                    { code: '4.B', text: 'Nh·ªØng g√¨ g·∫Øn k·∫øt t·ªï ch·ª©c l·∫°i v·ªõi nhau l√† cam k·∫øt ƒë·ªïi m·ªõi v√† ph√°t tri·ªÉn. T√≠nh ƒëi ƒë·∫ßu v·ªÅ m·∫∑t ti√™u chu·∫©n.' },
                    { code: '4.C', text: 'Nh·ªØng g√¨ g·∫Øn k·∫øt t·ªï ch·ª©c l·∫°i v·ªõi nhau l√† ch√∫ tr·ªçng th√†nh t√≠ch v√† ho√†n th√†nh m·ª•c ti√™u. Tham v·ªçng v√† chi·∫øn th·∫Øng l√† ch·ªß ƒë·ªÅ chung.' },
                    { code: '4.D', text: 'Nh·ªØng g√¨ g·∫Øn k·∫øt t·ªï ch·ª©c l·∫°i v·ªõi nhau l√† c√°c ch√≠nh s√°ch v√† quy t·∫Øc ch√≠nh th·ª©c. Duy tr√¨ ho·∫°t ƒë·ªông tr√¥i ch·∫£y c·ªßa t·ªï ch·ª©c l√† quan tr·ªçng.' }
                ]
            },
            {
                id: 'V',
                title: 'V. Tr·ªçng t√¢m chi·∫øn l∆∞·ª£c',
                questions: [
                    { code: '5.A', text: 'T·ªï ch·ª©c nh·∫•n m·∫°nh ph√°t tri·ªÉn con ng∆∞·ªùi. S·ª± tin c·∫≠y cao, c·ªüi m·ªü v√† s·ª± tham gia duy tr√¨ li√™n t·ª•c.' },
                    { code: '5.B', text: 'T·ªï ch·ª©c nh·∫•n m·∫°nh vi·ªác c√≥ ƒë∆∞·ª£c c√°c ngu·ªìn l·ª±c m·ªõi v√† t·∫°o ra nh·ªØng th√°ch th·ª©c m·ªõi. Th·ª≠ nghi·ªám nh·ªØng ƒëi·ªÅu m·ªõi v√† t√¨m ki·∫øm c∆° h·ªôi ƒë∆∞·ª£c ƒë√°nh gi√° cao.' },
                    { code: '5.C', text: 'T·ªï ch·ª©c nh·∫•n m·∫°nh c√°c h√†nh ƒë·ªông c·∫°nh tranh v√† th√†nh t√≠ch. ƒê·∫°t ƒë∆∞·ª£c m·ª•c ti√™u kh√≥ khƒÉn v√† th·∫Øng l·ª£i tr√™n th·ªã tr∆∞·ªùng l√† ∆∞u ti√™n h√†ng ƒë·∫ßu.' },
                    { code: '5.D', text: 'T·ªï ch·ª©c nh·∫•n m·∫°nh t√≠nh b·ªÅn v·ªØng v√† ·ªïn ƒë·ªãnh. Hi·ªáu qu·∫£, ki·ªÉm so√°t v√† ho·∫°t ƒë·ªông tr√¥i ch·∫£y l√† quan tr·ªçng.' }
                ]
            },
            {
                id: 'VI',
                title: 'VI. Ti√™u ch√≠ th√†nh c√¥ng',
                questions: [
                    { code: '6.A', text: 'T·ªï ch·ª©c ƒë·ªãnh nghƒ©a th√†nh c√¥ng d·ª±a tr√™n ph√°t tri·ªÉn ngu·ªìn nh√¢n l·ª±c, l√†m vi·ªác nh√≥m, cam k·∫øt c·ªßa nh√¢n vi√™n v√† quan t√¢m ƒë·∫øn con ng∆∞·ªùi.' },
                    { code: '6.B', text: 'T·ªï ch·ª©c ƒë·ªãnh nghƒ©a th√†nh c√¥ng d·ª±a tr√™n vi·ªác c√≥ s·∫£n ph·∫©m ƒë·ªôc ƒë√°o ho·∫∑c m·ªõi nh·∫•t. ƒê√≥ l√† ng∆∞·ªùi d·∫´n ƒë·∫ßu s·∫£n ph·∫©m v√† ƒë·ªïi m·ªõi.' },
                    { code: '6.C', text: 'T·ªï ch·ª©c ƒë·ªãnh nghƒ©a th√†nh c√¥ng d·ª±a tr√™n th·∫Øng l·ª£i tr√™n th·ªã tr∆∞·ªùng v√† v∆∞·ª£t qua ƒë·ªëi th·ªß c·∫°nh tranh. Th·ªã ph·∫ßn c·∫°nh tranh l√† then ch·ªët.' },
                    { code: '6.D', text: 'T·ªï ch·ª©c ƒë·ªãnh nghƒ©a th√†nh c√¥ng d·ª±a tr√™n hi·ªáu qu·∫£. Vi·ªác ph√¢n ph·ªëi ƒë√°ng tin c·∫≠y, l·∫≠p k·∫ø ho·∫°ch tr√¥i ch·∫£y v√† chi ph√≠ th·∫•p l√† c√°c y·∫øu t·ªë quan tr·ªçng.' }
                ]
            }
        ];

        let responses = {};

        function initializeSurvey() {
            const content = document.getElementById('surveyContent');
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('surveyDate').value = today;

            surveyData.forEach(section => {
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'section';
                sectionDiv.innerHTML = `
                    <div class="section-header">
                        <h2>${section.title}</h2>
                    </div>
                    <table class="section-table">
                        <thead>
                            <tr>
                                <th>M√£</th>
                                <th>C√¢u h·ªèi</th>
                                <th>Hi·ªán t·∫°i</th>
                                <th>Mong mu·ªën</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${section.questions.map(question => `
                                <tr>
                                    <td class="question-code">${question.code}</td>
                                    <td class="question-text">${question.text}</td>
                                    <td style="text-align: center;">
                                        <input type="number" class="score-input" 
                                               min="0" max="100" 
                                               id="${section.id}-${question.code}-current"
                                               onchange="updateResponse('${section.id}', '${question.code}', 'current', this.value)">
                                    </td>
                                    <td style="text-align: center;">
                                        <input type="number" class="score-input" 
                                               min="0" max="100" 
                                               id="${section.id}-${question.code}-desired"
                                               onchange="updateResponse('${section.id}', '${question.code}', 'desired', this.value)">
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                        <tfoot>
                            <tr class="total-row">
                                <td colspan="2" style="text-align: center; font-weight: bold;">T·ªïng c·ªông:</td>
                                <td id="${section.id}-total-current" class="total-invalid" style="text-align: center;">0</td>
                                <td id="${section.id}-total-desired" class="total-invalid" style="text-align: center;">0</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
                content.appendChild(sectionDiv);
            });

            updateCultureScores();
        }

        function updateResponse(sectionId, questionCode, type, value) {
            const key = `${sectionId}-${questionCode}-${type}`;
            responses[key] = parseInt(value) || 0;
            updateTotals();
            updateCultureScores();
            updateButtons();
        }

        function updateTotals() {
            surveyData.forEach(section => {
                let currentTotal = 0;
                let desiredTotal = 0;
                
                section.questions.forEach(question => {
                    const currentKey = `${section.id}-${question.code}-current`;
                    const desiredKey = `${section.id}-${question.code}-desired`;
                    currentTotal += responses[currentKey] || 0;
                    desiredTotal += responses[desiredKey] || 0;
                });

                const currentTotalElement = document.getElementById(`${section.id}-total-current`);
                const desiredTotalElement = document.getElementById(`${section.id}-total-desired`);
                
                currentTotalElement.textContent = currentTotal;
                desiredTotalElement.textContent = desiredTotal;
                
                currentTotalElement.className = currentTotal === 100 ? 'total-valid' : 'total-invalid';
                desiredTotalElement.className = desiredTotal === 100 ? 'total-valid' : 'total-invalid';
            });
        }

        function updateCultureScores() {
            const cultureTypes = ['A', 'B', 'C', 'D'];
            const cultureNames = ['Clan (Gia ƒë√¨nh)', 'Adhocracy (ƒê·ªïi m·ªõi)', 'Market (Th·ªã tr∆∞·ªùng)', 'Hierarchy (Ph√¢n c·∫•p)'];
            const cultureClasses = ['culture-clan', 'culture-adhocracy', 'culture-market', 'culture-hierarchy'];
            
            const scoresDiv = document.getElementById('cultureScores');
            scoresDiv.innerHTML = '';
            
            cultureTypes.forEach((type, index) => {
                let currentTotal = 0;
                let desiredTotal = 0;
                
                surveyData.forEach(section => {
                    const question = section.questions.find(q => q.code.endsWith(type));
                    if (question) {
                        const currentKey = `${section.id}-${question.code}-current`;
                        const desiredKey = `${section.id}-${question.code}-desired`;
                        currentTotal += responses[currentKey] || 0;
                        desiredTotal += responses[desiredKey] || 0;
                    }
                });
                
                const currentAvg = Math.round(currentTotal / surveyData.length * 10) / 10;
                const desiredAvg = Math.round(desiredTotal / surveyData.length * 10) / 10;
                
                const cultureCard = document.createElement('div');
                cultureCard.className = `culture-card ${cultureClasses[index]}`;
                cultureCard.innerHTML = `
                    <h4>${cultureNames[index]}</h4>
                    <div class="culture-scores">
                        <span>Hi·ªán t·∫°i: ${currentAvg}</span>
                        <span>Mong mu·ªën: ${desiredAvg}</span>
                    </div>
                `;
                scoresDiv.appendChild(cultureCard);
            });
        }

        function updateButtons() {
            const isValid = surveyData.every(section => {
                let currentTotal = 0;
                let desiredTotal = 0;
                
                section.questions.forEach(question => {
                    const currentKey = `${section.id}-${question.code}-current`;
                    const desiredKey = `${section.id}-${question.code}-desired`;
                    currentTotal += responses[currentKey] || 0;
                    desiredTotal += responses[desiredKey] || 0;
                });
                
                return currentTotal === 100 && desiredTotal === 100;
            });

            const name = document.getElementById('participantName').value;
            const canExport = isValid && name.trim() !== '';
            
            const exportBtn = document.getElementById('exportBtn');
            const completeBtn = document.getElementById('completeBtn');
            
            exportBtn.disabled = !canExport;
            exportBtn.className = canExport ? 'btn btn-success' : 'btn btn-disabled';
            
            completeBtn.disabled = !isValid;
            completeBtn.className = isValid ? 'btn btn-primary' : 'btn btn-disabled';
            
            showAlert(isValid);
        }

        function showAlert(isValid) {
            const alertDiv = document.getElementById('alertMessage');
            
            if (isValid) {
                alertDiv.innerHTML = `
                    <div class="alert alert-success">
                        ‚úÖ Kh·∫£o s√°t ƒë√£ ho√†n th√†nh! T·∫•t c·∫£ c√°c ph·∫ßn ƒë·ªÅu c√≥ t·ªïng ƒëi·ªÉm = 100.
                    </div>
                `;
            } else {
                alertDiv.innerHTML = `
                    <div class="alert alert-warning">
                        ‚ö†Ô∏è Vui l√≤ng ƒë·∫£m b·∫£o t·ªïng ƒëi·ªÉm c·ªßa m·ªói ph·∫ßn = 100 ƒë·ªÉ ho√†n th√†nh kh·∫£o s√°t.
                    </div>
                `;
            }
        }

        function exportToCSV() {
            const participantInfo = {
                name: document.getElementById('participantName').value,
                department: document.getElementById('participantDepartment').value,
                position: document.getElementById('participantPosition').value,
                date: document.getElementById('surveyDate').value
            };

            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "OCAI Survey Results\n";
            csvContent += `Participant,${participantInfo.name}\n`;
            csvContent += `Department,${participantInfo.department}\n`;
            csvContent += `Position,${participantInfo.position}\n`;
            csvContent += `Date,${participantInfo.date}\n\n`;
            
            csvContent += "Section,Question Code,Question,Current Score,Desired Score\n";
            
            surveyData.forEach(section => {
                section.questions.forEach(question => {
                    const currentKey = `${section.id}-${question.code}-current`;
                    const desiredKey = `${section.id}-${question.code}-desired`;
                    const currentScore = responses[currentKey] || 0;
                    const desiredScore = responses[desiredKey] || 0;
                    
                    csvContent += `${section.title},${question.code},"${question.text}",${currentScore},${desiredScore}\n`;
                });
            });
            
            // Th√™m t·ªïng k·∫øt vƒÉn h√≥a
            csvContent += "\nCulture Summary\n";
            csvContent += "Culture Type,Current Average,Desired Average\n";
            
            const cultureTypes = ['A', 'B', 'C', 'D'];
            const cultureNames = ['Clan (Gia ƒë√¨nh)', 'Adhocracy (ƒê·ªïi m·ªõi)', 'Market (Th·ªã tr∆∞·ªùng)', 'Hierarchy (Ph√¢n c·∫•p)'];
            
            cultureTypes.forEach((type, index) => {
                let currentTotal = 0;
                let desiredTotal = 0;
                
                surveyData.forEach(section => {
                    const question = section.questions.find(q => q.code.endsWith(type));
                    if (question) {
                        const currentKey = `${section.id}-${question.code}-current`;
                        const desiredKey = `${section.id}-${question.code}-desired`;
                        currentTotal += responses[currentKey] || 0;
                        desiredTotal += responses[desiredKey] || 0;
                    }
                });
                
                const currentAvg = Math.round(currentTotal / surveyData.length * 10) / 10;
                const desiredAvg = Math.round(desiredTotal / surveyData.length * 10) / 10;
                
                csvContent += `${cultureNames[index]},${currentAvg},${desiredAvg}\n`;
            });
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `OCAI_Survey_${participantInfo.name}_${participantInfo.date}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert("K·∫øt qu·∫£ kh·∫£o s√°t ƒë√£ ƒë∆∞·ª£c xu·∫•t ra file CSV!");
        }

        function completeSurvey() {
            const participantInfo = {
                name: document.getElementById('participantName').value,
                department: document.getElementById('participantDepartment').value,
                position: document.getElementById('participantPosition').value,
                date: document.getElementById('surveyDate').value
            };

            let resultText = `Kh·∫£o s√°t OCAI ho√†n th√†nh!\n\n`;
            resultText += `Ng∆∞·ªùi tham gia: ${participantInfo.name}\n`;
            resultText += `Ph√≤ng ban: ${participantInfo.department}\n`;
            resultText += `Ch·ª©c v·ª•: ${participantInfo.position}\n`;
            resultText += `Ng√†y kh·∫£o s√°t: ${participantInfo.date}\n\n`;
            
            resultText += `K·∫øt qu·∫£ theo lo·∫°i vƒÉn h√≥a:\n`;
            
            const cultureTypes = ['A', 'B', 'C', 'D'];
            const cultureNames = ['Clan (Gia ƒë√¨nh)', 'Adhocracy (ƒê·ªïi m·ªõi)', 'Market (Th·ªã tr∆∞·ªùng)', 'Hierarchy (Ph√¢n c·∫•p)'];
            
            cultureTypes.forEach((type, index) => {
                let currentTotal = 0;
                let desiredTotal = 0;
                
                surveyData.forEach(section => {
                    const question = section.questions.find(q => q.code.endsWith(type));
                    if (question) {
                        const currentKey = `${section.id}-${question.code}-current`;
                        const desiredKey = `${section.id}-${question.code}-desired`;
                        currentTotal += responses[currentKey] || 0;
                        desiredTotal += responses[desiredKey] || 0;
                    }
                });
                
                const currentAvg = Math.round(currentTotal / surveyData.length * 10) / 10;
                const desiredAvg = Math.round(desiredTotal / surveyData.length * 10) / 10;
                
                resultText += `${cultureNames[index]}: Hi·ªán t·∫°i ${currentAvg} - Mong mu·ªën ${desiredAvg}\n`;
            });
            
            alert(resultText);
        }

        // Kh·ªüi t·∫°o kh·∫£o s√°t khi trang ƒë∆∞·ª£c load
        document.addEventListener('DOMContentLoaded', function() {
            initializeSurvey();
        });
    </script>
</body>
</html>
