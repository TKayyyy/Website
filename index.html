    <!DOCTYPE html>
    <html lang="vi">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>OCAI Survey - Kh·∫£o s√°t VƒÉn h√≥a T·ªï ch·ª©c</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Arial', sans-serif;
                background-color: #f5f5f5;
                color: #333;
                line-height: 1.6;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                background-color: white;
                min-height: 100vh;
            }

            .header {
                text-align: center;
                margin-bottom: 40px;
                padding: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border-radius: 15px;
                color: white;
            }

            .header h1 {
                font-size: 2.5em;
                margin-bottom: 10px;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            }

            .header p {
                font-size: 1.2em;
                opacity: 0.9;
            }

            .info-section {
                background-color: #f8f9fa;
                padding: 25px;
                border-radius: 10px;
                margin-bottom: 30px;
                border-left: 5px solid #667eea;
            }

            .info-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin-bottom: 20px;
            }

            .info-item {
                display: flex;
                flex-direction: column;
            }

            .info-item label {
                font-weight: bold;
                margin-bottom: 5px;
                color: #555;
            }

            .info-item input {
                padding: 10px;
                border: 2px solid #ddd;
                border-radius: 5px;
                font-size: 16px;
                transition: border-color 0.3s;
            }

            .info-item input:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            }

            .instructions {
                background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
                padding: 20px;
                border-radius: 10px;
                margin-bottom: 30px;
                border-left: 5px solid #2196f3;
            }

            .instructions h3 {
                color: #1976d2;
                margin-bottom: 15px;
                font-size: 1.3em;
            }

            .instructions p {
                margin-bottom: 10px;
                color: #555;
            }

            .section {
                margin-bottom: 40px;
                border: 2px solid #e0e0e0;
                border-radius: 15px;
                overflow: hidden;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                transition: transform 0.2s;
            }

            .section:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            }

            .section-header {
                background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                padding: 20px;
                border-bottom: 2px solid #ddd;
            }

            .section-header h2 {
                color: #2c3e50;
                font-size: 1.4em;
            }

            .section-table {
                width: 100%;
                border-collapse: collapse;
                background: white;
            }

            .section-table th {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px;
                text-align: center;
                font-weight: bold;
                border: 1px solid #ddd;
            }

            .section-table th:first-child {
                width: 80px;
            }

            .section-table th:nth-child(3),
            .section-table th:nth-child(4) {
                width: 100px;
            }

            .section-table td {
                padding: 15px;
                border: 1px solid #ddd;
                vertical-align: top;
            }

            .section-table tr:nth-child(even) {
                background-color: #f9f9f9;
            }

            .section-table tr:hover {
                background-color: #f0f8ff;
            }

            .question-code {
                font-weight: bold;
                color: #667eea;
                text-align: center;
                font-size: 1.1em;
            }

            .question-text {
                line-height: 1.6;
                color: #444;
            }

            .score-input {
                width: 60px;
                padding: 8px;
                text-align: center;
                border: 2px solid #ddd;
                border-radius: 5px;
                font-size: 16px;
                font-weight: bold;
                transition: all 0.3s;
            }

            .score-input:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
            }

            .total-row {
                background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
                font-weight: bold;
                font-size: 1.1em;
            }

            .total-valid {
                color: #28a745;
            }

            .total-invalid {
                color: #dc3545;
            }

            .summary-section {
                background: linear-gradient(135deg, #fff9e6 0%, #ffecb3 100%);
                padding: 30px;
                border-radius: 15px;
                margin: 40px 0;
                border: 2px solid #ffc107;
            }

            .summary-section h3 {
                color: #e65100;
                margin-bottom: 20px;
                font-size: 1.5em;
                text-align: center;
            }

            .culture-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
            }

            .culture-card {
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                transition: transform 0.2s;
                border: 2px solid transparent;
            }

            .culture-card:hover {
                transform: translateY(-3px);
                border-color: #667eea;
            }

            .culture-clan {
                background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
                color: #1976d2;
            }

            .culture-adhocracy {
                background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
                color: #2e7d32;
            }

            .culture-market {
                background: linear-gradient(135deg, #fff3e0 0%, #ffcc80 100%);
                color: #ef6c00;
            }

            .culture-hierarchy {
                background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
                color: #c2185b;
            }

            .culture-card h4 {
                font-size: 1.2em;
                margin-bottom: 15px;
            }

            .culture-scores {
                display: flex;
                justify-content: space-between;
                margin-top: 10px;
            }

            .culture-scores span {
                font-weight: bold;
                font-size: 1.1em;
            }

            .button-group {
                display: flex;
                gap: 20px;
                margin-top: 40px;
                flex-wrap: wrap;
            }

            .btn {
                flex: 1;
                padding: 15px 30px;
                border: none;
                border-radius: 10px;
                font-size: 1.1em;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s;
                text-transform: uppercase;
                letter-spacing: 1px;
                min-width: 200px;
            }

            .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                display: flex;
                justify-content: center;
            }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            }

            .btn-success {
                background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
                color: white;
            }

            .btn-success:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(86, 171, 47, 0.4);
            }

            .btn-disabled {
                background: #cccccc;
                color: #666;
                cursor: not-allowed;
            }

            .btn-disabled:hover {
                transform: none;
                box-shadow: none;
            }

            .alert {
                padding: 20px;
                border-radius: 10px;
                margin-top: 20px;
                border-left: 5px solid #ffc107;
            }

            .alert-warning {
                background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
                color: #856404;
            }

            .alert-success {
                background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
                color: #155724;
                border-left-color: #28a745;
            }

            .alert-over-100 {
                background-color: #f8d7da;
                color: #721c24;
                padding: 8px 12px;
                border-radius: 5px;
                border: 1px solid #f5c6cb;
                font-size: 12px;
                margin-top: 5px;
                text-align: center;
                font-weight: normal;
                width: 100%;           /* Th√™m d√≤ng n√†y */
                box-sizing: border-box; /* Th√™m d√≤ng n√†y */
                display: block; 
                }

            @media (max-width: 768px) {
                .container {
                    padding: 10px;
                }

                .header h1 {
                    font-size: 2em;
                }

                .info-grid {
                    grid-template-columns: 1fr;
                }

                .section-table th,
                .section-table td {
                    padding: 10px 8px;
                    font-size: 14px;
                }

                .score-input {
                    width: 50px;
                    font-size: 14px;
                }

                .culture-grid {
                    grid-template-columns: 1fr;
                }

                .button-group {
                    flex-direction: column;
                }

                .btn {
                    min-width: auto;
                }
            }

            .introduction-section {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        padding: 25px;
        border-radius: 10px;
        margin-bottom: 30px;
        border-left: 5px solid #28a745;
    }

    .introduction-section h3 {
        color: #155724;
        margin-bottom: 15px;
        font-size: 1.3em;
    }

    .introduction-section ul {
        margin: 15px 0;
        padding-left: 20px;
    }

    .introduction-section li {
        margin-bottom: 8px;
        line-height: 1.5;
    }

            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
                background-color: #f8f9fa;
                line-height: 1.6;
            }
            .container {
                background-color: white;
                padding: 30px;
                border-radius: 10px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
            h3 {
                color: #2c3e50;
                border-bottom: 3px solid #3498db;
                padding-bottom: 10px;
                margin-bottom: 20px;
            }
            .highlight {
                background-color: #e8f4f8;
                padding: 15px;
                border-left: 4px solid #3498db;
                margin: 15px 0;
            }
            .time-info {
                background-color: #fff3cd;
                padding: 10px;
                border-radius: 5px;
                border-left: 4px solid #ffc107;
                margin: 15px 0;
            }
            .thank-you {
                background-color: #d4edda;
                padding: 15px;
                border-radius: 5px;
                border-left: 4px solid #28a745;
                margin-top: 20px;
                font-style: italic;
            }

            ul {
                margin: 10px 0;
            }
            li {
                margin: 8px 0;
            }
            .bold {
                font-weight: bold;
            }

            #globalAlert {
        position: sticky;
        top: 0;
        z-index: 100;
        animation: slideDown 0.3s ease-out;
    }

    @keyframes slideDown {
        from {
            transform: translateY(-100%);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    /* Toast notification styles */
    .toast-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        min-width: 300px;
        max-width: 400px;
        padding: 15px 20px;
        border-radius: 8px;
        color: white;
        font-weight: bold;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        animation: slideInFromRight 0.5s ease-out;
        cursor: pointer;
    }

    .toast-warning {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        border-left: 4px solid #ff3838;
    }

    .toast-close {
        position: absolute;
        top: 8px;
        right: 12px;
        font-size: 18px;
        cursor: pointer;
        opacity: 0.8;
    }

    @keyframes slideInFromRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
#completeBtn {
    flex: none !important;
    width: auto !important;
    margin: 0 auto;
}
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>KH·∫¢O S√ÅT VƒÇN H√ìA T·ªî CH·ª®C</h1>
                <p>Organizational Culture Assessment Instrument (OCAI)</p>
            </div>


    <div class="container">
            <h3>üìã Gi·ªõi thi·ªáu v·ªÅ kh·∫£o s√°t OCAI - VƒÉn h√≥a T·ªï ch·ª©c</h3>
            <p><strong>Xin ch√†o anh/ch·ªã!</strong></p>
            <p>Ch√∫ng em l√† sinh vi√™n ng√†nh Quan h·ªá c√¥ng ch√∫ng - Tr∆∞·ªùng ƒê·∫°i h·ªçc VƒÉn Lang, hi·ªán ƒëang theo h·ªçc h·ªçc ph·∫ßn VƒÉn h√≥a Doanh nghi·ªáp. </p>
            
            <div class="highlight">
                <p><strong>üîç M·ª•c ƒë√≠ch kh·∫£o s√°t:</strong> ƒê√¢y l√† kh·∫£o s√°t m√† ch√∫ng em s·ª≠ d·ª•ng c√¥ng c·ª• OCAI (Organizational Culture Assessment Instrument) ƒë·ªÉ ƒë√°nh gi√° nh·∫≠n th·ª©c hi·ªán t·∫°i v√† mong mu·ªën t∆∞∆°ng lai v·ªÅ c√°c y·∫øu t·ªë c·∫•u th√†nh vƒÉn h√≥a t·∫°i TechVibe t·ª´ g√≥c nh√¨n nh√¢n vi√™n n·ªôi b·ªô. </p>
            </div>

            <div class="time-info">
                <p><strong>‚è∞ Th·ªùi gian th·ª±c hi·ªán:</strong> 10‚Äì12 ph√∫t</p>
            </div>

            <p><strong>üë• ƒê·ªëi t∆∞·ª£ng kh·∫£o s√°t:</strong></p>
            <ul>
                <li>Qu√Ω Th·∫ßy/C√¥ Gi·∫£ng vi√™n c·ªßa Tr∆∞·ªùng ƒê·∫°i h·ªçc VƒÉn Lang</li>
                <li>Anh/Ch·ªã C√°n b·ªô, Nh√¢n vi√™n c·ªßa Tr∆∞·ªùng</li>
                <li>Sinh vi√™n ƒëang h·ªçc t·∫°i Tr∆∞·ªùng</li>
            </ul>

            <p><strong>üîí Cam k·∫øt b·∫£o m·∫≠t:</strong></p>
            <ul>
                <li>Kh·∫£o s√°t n√†y ho√†n to√†n ·∫©n danh v√† ch·ªâ ph·ª•c v·ª• m·ª•c ƒë√≠ch h·ªçc thu·∫≠t</li>
                <li>Th√¥ng tin thu th·∫≠p s·∫Ω ƒë∆∞·ª£c b·∫£o m·∫≠t v√† kh√¥ng chia s·∫ª ra ngo√†i ph·∫°m vi nghi√™n c·ª©u</li>
                <li>K·∫øt qu·∫£ ch·ªâ ƒë∆∞·ª£c s·ª≠ d·ª•ng cho b√†i t·∫≠p m√¥n h·ªçc</li>
            </ul>
            <div class="thank-you">
                <p><strong>üôè Ch√∫ng em xin ch√¢n th√†nh c·∫£m ∆°n!</strong></p>
                <p>üíå R·∫•t mong anh/ch·ªã c√≥ th·ªÉ d√†nh √≠t ph√∫t qu√Ω b√°u ƒë·ªÉ ho√†n th√†nh kh·∫£o s√°t n√†y. M·ªói √Ω ki·∫øn ƒë√≥ng g√≥p l√† m·ªôt b∆∞·ªõc ti·∫øn gi√∫p ch√∫ng em hi·ªÉu r√µ h∆°n v·ªÅ vƒÉn ho√° l√†m vi·ªác t·∫°i TechVibe</p>
            </div>
        </div>

    <div id="globalAlert" class="alert alert-warning" style="display: none; margin-bottom: 20px;">
    </div>

    </div>
            <div class="info-section">

                <h3>Th√¥ng tin ng∆∞·ªùi tham gia</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <label>H·ªç v√† t√™n:</label>
                        <input type="text" id="participantName" placeholder="Nh·∫≠p h·ªç v√† t√™n" onchange="updateButtons()">
                    </div>
                    <div class="info-item">
                        <label>Ph√≤ng ban:</label>
                        <input type="text" id="participantDepartment" placeholder="Nh·∫≠p ph√≤ng ban">
                    </div>
                    <div class="info-item">
                        <label>Ch·ª©c v·ª•:</label>
                        <input type="text" id="participantPosition" placeholder="Nh·∫≠p ch·ª©c v·ª•">
                    </div>
                    <div class="info-item">
                        <label>Ng√†y kh·∫£o s√°t:</label>
                        <input type="date" id="surveyDate">
                    </div>
                </div>
            </div>

            <div class="instructions">
                <h3>üéØ H∆∞·ªõng d·∫´n </h3>
                <p>V·ªõi m·ªói nh√≥m c√¢u h·ªèi, Th·∫ßy/C√¥/Anh/Ch·ªã h√£y <strong>ph√¢n b·ªï 100 ƒëi·ªÉm</strong> cho 2 m√¥ t·∫£ t∆∞∆°ng ·ª©ng, ·ªü hai c·ªôt: </p>
                <p> <strong>"Hi·ªán t·∫°i"</strong> - ph·∫£n ·∫£nh th·ª±c tr·∫°ng hi·ªán nay t·∫°i t·ªï ch·ª©c gi√°o d·ª•c b·∫°n ƒëang l√†m vi·ªác.</p>
                <p><strong>"Mong mu·ªën"</strong> - ph·∫£n ·∫£nh ƒë·ªãnh h∆∞·ªõng b·∫°n mong mu·ªën t·ªï ch·ª©c h∆∞·ªõng ƒë·∫øn trong t∆∞∆°ng lai.</p>
                <p>T·ªïng ƒëi·ªÉm m·ªói c·ªôt <strong>Hi·ªán t·∫°i</strong> ho·∫∑c <strong>Mong mu·ªën</strong> lu√¥n <strong>ph·∫£i b·∫±ng 100.</strong></p>
                <p> <strong>‚ùó Kh√¥ng b·∫Øt bu·ªôc chia ƒë·ªÅu.</strong></p>
            </div>

            <div id="surveyContent"></div>

            <div class="summary-section">
                <h3>üìä T√≥m t·∫Øt ƒëi·ªÉm s·ªë theo lo·∫°i vƒÉn h√≥a</h3>
                <div class="culture-grid" id="cultureScores"></div>
            </div>

<div style="text-align: center;">
    <button class="btn btn-success" id="completeBtn" onclick="completeSurvey()" style="flex: none; width: auto;">
        üì§ G·ª≠i kh·∫£o s√°t & Ho√†n t·∫•t
    </button>
</div>

            <div id="alertMessage"></div>
        </div>

            <script>
            // Thay th·∫ø URL n√†y b·∫±ng URL Web App c·ªßa b·∫°n
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxq21cxPHArFouk-IFxoWNBUFYDBXO7IqkfnxQ28MpbIMN_RyEhWaCHLQj5IO35zLK14Q/exec';
            
        
        </script>

        <script>
            const surveyData = [
                {
                    id: 'I',
                    title: 'I. Nh·ªØng ƒë·∫∑c ƒëi·ªÉm c·ªßa t·ªï ch·ª©c',
                    questions: [
                        { code: '1.A', text: 'T·ªï ch·ª©c gi·ªëng nh∆∞ m·ªôt gia ƒë√¨nh l·ªõn ‚Äì th√¢n thi·ªán, h·ªó tr·ª£, g·∫ßn g≈©i nh∆∞ anh em ƒë·ªìng nghi·ªáp.' },
                        { code: '1.B', text: 'T·ªï ch·ª©c l√†  l√† m√¥i tr∆∞·ªùng ƒë·ªïi m·ªõi, th·ª≠ nghi·ªám, s√°ng t·∫°o kh√¥ng gi·ªõi h·∫°n.' },
                        { code: '1.C', text: 'T·ªï ch·ª©c nh·∫•n m·∫°nh hi·ªáu qu·∫£, ch·ªâ s·ªë, KPI, th√†nh t√≠ch v√† nƒÉng su·∫•t.' },
                        { code: '1.D', text: 'T·ªï ch·ª©c v·∫≠n h√†nh theo h·ªá th·ªëng r√µ r√†ng, quy tr√¨nh nghi√™m ng·∫∑t v√† tu√¢n th·ªß.' }
                    ]
                },
                {
                    id: 'II',
                    title: 'II. Phong c√°ch l√£nh ƒë·∫°o',
                    questions: [
                        { code: '2.A', text: 'L√£nh ƒë·∫°o l√† c·ªë v·∫•n, mentor ‚Äì truy·ªÅn c·∫£m h·ª©ng v√† ƒë·ªãnh h∆∞·ªõng.' },
                        { code: '2.B', text: 'L√£nh ƒë·∫°o l√† ng∆∞·ªùi ƒë·ªïi m·ªõi, d·∫´n ƒë·∫ßu xu h∆∞·ªõng v√† s·∫µn s√†ng ch·∫•p nh·∫≠n r·ªßi ro.' },
                        { code: '2.C', text: 'L√£nh ƒë·∫°o l√† ng∆∞·ªùi ƒëi·ªÅu ph·ªëi, t·ªï ch·ª©c hi·ªáu qu·∫£ v√† ƒë·∫°t m·ª•c ti√™u.' },
                        { code: '2.D', text: 'L√£nh ƒë·∫°o l√† nh√† qu·∫£n l√Ω theo h·ªá th·ªëng, ·ªïn ƒë·ªãnh v√† ƒë·∫£m b·∫£o tr·∫≠t t·ª±' }
                    ]
                },
                {
                    id: 'III',
                    title: 'III. Qu·∫£n l√Ω ƒë·ªôi ng≈© (nh√¢n s·ª± ‚Äì gi√°o vi√™n ‚Äì nh√¢n vi√™n)',
                    questions: [
                        { code: '3.A', text: 'L√†m vi·ªác nh√≥m, ƒë·ªìng thu·∫≠n, chia s·∫ª v√† h·ª£p t√°c.' },
                        { code: '3.B', text: 'T·ª± do, ƒë·ªôc l·∫≠p, ch·∫•p nh·∫≠n r·ªßi ro ‚Äì khuy·∫øn kh√≠ch c√°i t√¥i s√°ng t·∫°o.' },
                        { code: '3.C', text: 'Hi·ªáu su·∫•t cao, c·∫°nh tranh, th√†nh t√≠ch r√µ r√†ng.' },
                        { code: '3.D', text: 'B·∫£o ƒë·∫£m vi·ªác l√†m, ·ªïn ƒë·ªãnh m·ªëi quan h·ªá, h√†i ho√† v√† an to√†n.' }
                    ]
                },
                {
                    id: 'IV',
                    title: 'IV. Tinh th·∫ßn g·∫Øn k·∫øt t·ªï ch·ª©c',
                    questions: [
                        { code: '4.A', text: 'G·∫Øn k·∫øt b·ªüi l√≤ng tin, trung th√†nh v√† ni·ªÅm tin n·ªôi b·ªô.' },
                        { code: '4.B', text: 'G·∫Øn k·∫øt b·ªüi m·ª•c ti√™u ph√°t tri·ªÉn, ƒë·ªïi m·ªõi v√† chinh ph·ª•c th·ª≠ th√°ch.' },
                        { code: '4.C', text: 'G·∫Øn k·∫øt b·ªüi m·ª•c ti√™u k·∫øt qu·∫£, kh√°t khao chi·∫øn th·∫Øng.' },
                        { code: '4.D', text: 'G·∫Øn k·∫øt b·ªüi ch√≠nh s√°ch, h·ªá th·ªëng n·ªôi quy, quy tr√¨nh ·ªïn ƒë·ªãnh.' }
                    ]
                },
                {
                    id: 'V',
                    title: 'V. ƒê·ªãnh h∆∞·ªõng chi·∫øn l∆∞·ª£c',
                    questions: [
                        { code: '5.A', text: 'Ph√°t tri·ªÉn con ng∆∞·ªùi, tham gia, g·∫Øn k·∫øt v√† ƒë√†o t·∫°o.' },
                        { code: '5.B', text: 'Khuy·∫øn kh√≠ch th·ª≠ th√°ch, ƒë·ªïi m·ªõi, t√¨m ki·∫øm c∆° h·ªôi.' },
                        { code: '5.C', text: 'T·∫≠p trung v√†o c·∫°nh tranh, tƒÉng tr∆∞·ªüng, k·∫øt qu·∫£ kinh doanh.' },
                        { code: '5.D', text: '∆Øu ti√™n t√≠nh b·ªÅn v·ªØng, ki·ªÉm so√°t v√† ho·∫°t ƒë·ªông tr∆°n tru.' }
                    ]
                },
                {
                    id: 'VI',
                    title: 'VI. Ti√™u ch√≠ ƒë√°nh gi√° th√†nh c√¥ng',
                    questions: [
                        { code: '6.A', text: 'Th√†nh c√¥ng l√† ph√°t tri·ªÉn con ng∆∞·ªùi v√† l√†m vi·ªác nh√≥m' },
                        { code: '6.B', text: 'Th√†nh c√¥ng l√† s·∫£n ph·∫©m, s√°ng t·∫°o v√† ƒë·ªïi m·ªõi.' },
                        { code: '6.C', text: 'TTh√†nh c√¥ng l√† th·ªã ph·∫ßn, v∆∞·ª£t ƒë·ªëi th·ªß, chi·∫øn th·∫Øng th·ªã tr∆∞·ªùng.' },
                        { code: '6.D', text: 'Th√†nh c√¥ng l√† hi·ªáu qu·∫£ v·∫≠n h√†nh, ph√¢n ph·ªëi ƒë√°ng tin v√† chi ph√≠ t·ªëi ∆∞u.' }
                    ]
                }
            ];

            let responses = {};

            function initializeSurvey() {
                const content = document.getElementById('surveyContent');
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('surveyDate').value = today;

                surveyData.forEach(section => {
                    const sectionDiv = document.createElement('div');
                    sectionDiv.className = 'section';
                    sectionDiv.innerHTML = `
                        <div class="section-header">
                            <h2>${section.title}</h2>
                        </div>
                        <table class="section-table">
                            <thead>
                                <tr>
                                    <th>M√£</th>
                                    <th>C√¢u h·ªèi</th>
                                    <th>Hi·ªán t·∫°i</th>
                                    <th>Mong mu·ªën</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${section.questions.map(question => `
                                    <tr>
                                        <td class="question-code">${question.code}</td>
                                        <td class="question-text">${question.text}</td>
                                        <td style="text-align: center;">
                                            <input type="number" class="score-input" 
                                                min="0" max="100" 
                                                id="${section.id}-${question.code}-current"
                                                onchange="updateResponse('${section.id}', '${question.code}', 'current', this.value)">
                                        </td>
                                        <td style="text-align: center;">
                                            <input type="number" class="score-input" 
                                                min="0" max="100" 
                                                id="${section.id}-${question.code}-desired"
                                                onchange="updateResponse('${section.id}', '${question.code}', 'desired', this.value)">
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                            <tfoot>
                                <tr class="total-row">
                                    <td colspan="2" style="text-align: center; font-weight: bold;">T·ªïng c·ªông:</td>
                                    <td id="${section.id}-total-current" class="total-invalid" style="text-align: center;">0</td>
                                    <td id="${section.id}-total-desired" class="total-invalid" style="text-align: center;">0</td>
                                </tr>
                            </tfoot>
                        </table>
                    `;
                    content.appendChild(sectionDiv);
                });

                updateCultureScores();

                
            }

            function updateResponse(sectionId, questionCode, type, value) {
                const key = `${sectionId}-${questionCode}-${type}`;
                responses[key] = parseInt(value) || 0;
                
                // Ki·ªÉm tra ngay l·∫≠p t·ª©c khi nh·∫≠p
                checkInstantTotal(sectionId);
                
                updateTotals();
                updateCultureScores();
                updateButtons();
            }

    function updateTotals() {
        surveyData.forEach(section => {
            let currentTotal = 0;
            let desiredTotal = 0;

            section.questions.forEach(question => {
                const currentKey = `${section.id}-${question.code}-current`;
                const desiredKey = `${section.id}-${question.code}-desired`;
                currentTotal += responses[currentKey] || 0;
                desiredTotal += responses[desiredKey] || 0;
            });

            const currentTotalElement = document.getElementById(`${section.id}-total-current`);
            const desiredTotalElement = document.getElementById(`${section.id}-total-desired`);

            currentTotalElement.textContent = currentTotal;
            desiredTotalElement.textContent = desiredTotal;

            currentTotalElement.className = currentTotal === 100 ? 'total-valid' : 'total-invalid';
            desiredTotalElement.className = desiredTotal === 100 ? 'total-valid' : 'total-invalid';

            // üÜï Hi·ªÉn th·ªã c·∫£nh b√°o n·∫øu > 100
            let alertId = `${section.id}-alert`;
            let alertElement = document.getElementById(alertId);
            if (!alertElement) {
                alertElement = document.createElement('div');
                alertElement.id = alertId;
                alertElement.style.marginTop = '10px';
                alertElement.style.fontWeight = 'bold';
                alertElement.style.color = '#dc3545'; // m√†u ƒë·ªè
                currentTotalElement.parentElement.parentElement.appendChild(alertElement);
            }

            if (currentTotal > 100 || desiredTotal > 100)  {
                alertElement.innerHTML = '';
            }
        });
    }


            function updateCultureScores() {
                const cultureTypes = ['A', 'B', 'C', 'D'];
                const cultureNames = ['Clan (Gia ƒë√¨nh)', 'Adhocracy (ƒê·ªïi m·ªõi)', 'Market (Th·ªã tr∆∞·ªùng)', 'Hierarchy (Ph√¢n c·∫•p)'];
                const cultureClasses = ['culture-clan', 'culture-adhocracy', 'culture-market', 'culture-hierarchy'];
                
                const scoresDiv = document.getElementById('cultureScores');
                scoresDiv.innerHTML = '';
                
                cultureTypes.forEach((type, index) => {
                    let currentTotal = 0;
                    let desiredTotal = 0;
                    
                    surveyData.forEach(section => {
                        const question = section.questions.find(q => q.code.endsWith(type));
                        if (question) {
                            const currentKey = `${section.id}-${question.code}-current`;
                            const desiredKey = `${section.id}-${question.code}-desired`;
                            currentTotal += responses[currentKey] || 0;
                            desiredTotal += responses[desiredKey] || 0;
                        }
                    });
                    
                    const currentAvg = Math.round(currentTotal / surveyData.length * 10) / 10;
                    const desiredAvg = Math.round(desiredTotal / surveyData.length * 10) / 10;
                    
                    const cultureCard = document.createElement('div');
                    cultureCard.className = `culture-card ${cultureClasses[index]}`;
                    cultureCard.innerHTML = `
                        <h4>${cultureNames[index]}</h4>
                        <div class="culture-scores">
                            <span>Hi·ªán t·∫°i: ${currentAvg}</span>
                            <span>Mong mu·ªën: ${desiredAvg}</span>
                        </div>
                    `;
                    scoresDiv.appendChild(cultureCard);
                });
            }

    function updateButtons() {
        const isValid = surveyData.every(section => {
            let currentTotal = 0;
            let desiredTotal = 0;
            
            section.questions.forEach(question => {
                const currentKey = `${section.id}-${question.code}-current`;
                const desiredKey = `${section.id}-${question.code}-desired`;
                currentTotal += responses[currentKey] || 0;
                desiredTotal += responses[desiredKey] || 0;
            });
            
            return currentTotal === 100 && desiredTotal === 100;
        });

        const name = document.getElementById('participantName').value;
        const canComplete = isValid && name.trim() !== '';
        
        // X√ìA PH·∫¶N N√ÄY
        // const exportBtn = document.getElementById('exportBtn');
        // exportBtn.disabled = !canExport;
        // exportBtn.className = canExport ? 'btn btn-success' : 'btn btn-disabled';
        
        const completeBtn = document.getElementById('completeBtn');
        completeBtn.disabled = !canComplete;
        completeBtn.className = canComplete ? 'btn btn-primary' : 'btn btn-disabled';
        
        showAlert(isValid);
    }

            function showAlert(isValid) {
                const alertDiv = document.getElementById('alertMessage');
                
                if (isValid) {
                    alertDiv.innerHTML = `
                        <div class="alert alert-success">
                            ‚úÖ Kh·∫£o s√°t ƒë√£ ho√†n th√†nh! T·∫•t c·∫£ c√°c ph·∫ßn ƒë·ªÅu c√≥ t·ªïng ƒëi·ªÉm = 100.
                        </div>
                    `;
                } else {
                    alertDiv.innerHTML = `
                        <div class="alert alert-warning">
                            ‚ö†Ô∏è Vui l√≤ng ƒë·∫£m b·∫£o t·ªïng ƒëi·ªÉm c·ªßa m·ªói ph·∫ßn = 100 ƒë·ªÉ ho√†n th√†nh kh·∫£o s√°t.
                        </div>
                    `;
                }
            }

    function completeSurvey() {
        // Th√™m loading indicator
        const completeBtn = document.getElementById('completeBtn');
        completeBtn.innerHTML = '‚è≥ ƒêang g·ª≠i...';
        completeBtn.disabled = true;
        
        const participantInfo = {
            name: document.getElementById('participantName').value,
            department: document.getElementById('participantDepartment').value,
            position: document.getElementById('participantPosition').value,
            date: document.getElementById('surveyDate').value
        };

        const cultureTypes = ['A', 'B', 'C', 'D'];
        let cultureScores = {};

        cultureTypes.forEach(type => {
            let currentTotal = 0;
            let desiredTotal = 0;

            surveyData.forEach(section => {
                const question = section.questions.find(q => q.code.endsWith(type));
                if (question) {
                    const currentKey = `${section.id}-${question.code}-current`;
                    const desiredKey = `${section.id}-${question.code}-desired`;
                    currentTotal += responses[currentKey] || 0;
                    desiredTotal += responses[desiredKey] || 0;
                }
            });

            cultureScores[`Current_${type}`] = Math.round(currentTotal / surveyData.length * 10) / 10;
            cultureScores[`Desired_${type}`] = Math.round(desiredTotal / surveyData.length * 10) / 10;
        });

        // Debug: Log d·ªØ li·ªáu tr∆∞·ªõc khi g·ª≠i
        console.log('Sending data:', {
            participantInfo,
            cultureScores
        });

        const formData = new FormData();
        formData.append('Name', participantInfo.name);
        formData.append('Department', participantInfo.department);
        formData.append('Position', participantInfo.position);
        formData.append('Date', participantInfo.date);

        for (let key in cultureScores) {
            formData.append(key, cultureScores[key]);
        }

        fetch(SCRIPT_URL, {
            method: 'POST',
            body: formData
        })
        .then(res => {
            console.log('Response status:', res.status);
            return res.text();
        })
        .then(data => {
            console.log('Response data:', data);
            alert("‚úÖ Kh·∫£o s√°t ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng!");
            completeBtn.innerHTML = 'üì§ ƒê√£ g·ª≠i th√†nh c√¥ng';
        })
        .catch(error => {
            console.error('Error:', error);
            alert("‚ùå L·ªói khi g·ª≠i kh·∫£o s√°t: " + error.message);
            completeBtn.innerHTML = 'üì§ G·ª≠i kh·∫£o s√°t & Ho√†n t·∫•t';
            completeBtn.disabled = false;
        });
    }

            // Kh·ªüi t·∫°o kh·∫£o s√°t khi trang ƒë∆∞·ª£c load
            document.addEventListener('DOMContentLoaded', function() {
                initializeSurvey();
            });

    //         function checkInstantTotal(sectionId) {
    //     const section = surveyData.find(s => s.id === sectionId);
    //     let currentTotal = 0;
    //     let desiredTotal = 0;
        
    //     section.questions.forEach(question => {
    //         const currentInput = document.getElementById(`${sectionId}-${question.code}-current`);
    //         const desiredInput = document.getElementById(`${sectionId}-${question.code}-desired`);
            
    //         currentTotal += parseInt(currentInput.value) || 0;
    //         desiredTotal += parseInt(desiredInput.value) || 0;
    //     });
        
    //     // Hi·ªÉn th·ªã th√¥ng b√°o ngay l·∫≠p t·ª©c
    //     const globalAlert = document.getElementById('globalAlert');
    //     if (currentTotal > 100 || desiredTotal > 100) {
    //         globalAlert.style.display = 'block';
    //         globalAlert.innerHTML = '‚ö†Ô∏è T·ªïng ƒëi·ªÉm v∆∞·ª£t qu√° 100. Vui l√≤ng ki·ªÉm tra l·∫°i.';
    //     } else {
    //         // Ki·ªÉm tra c√°c section kh√°c c√≥ v·∫•n ƒë·ªÅ kh√¥ng
    //         let hasOtherIssues = false;
    //         surveyData.forEach(otherSection => {
    //             if (otherSection.id !== sectionId) {
    //                 // Ki·ªÉm tra section kh√°c...
    //             }
    //         });
            
    //         if (!hasOtherIssues) {
    //             globalAlert.style.display = 'none';
    //         }
    //     }
    // }

    function checkInstantTotal(sectionId) {
        const section = surveyData.find(s => s.id === sectionId);
        let currentTotal = 0;
        let desiredTotal = 0;
        
        section.questions.forEach(question => {
            const currentInput = document.getElementById(`${sectionId}-${question.code}-current`);
            const desiredInput = document.getElementById(`${sectionId}-${question.code}-desired`);
            
            currentTotal += parseInt(currentInput.value) || 0;
            desiredTotal += parseInt(desiredInput.value) || 0;
        });
        
        // Hi·ªÉn th·ªã toast notification
        if (currentTotal > 100 || desiredTotal > 100) {
            const overType = currentTotal > 100 ? 'Hi·ªán t·∫°i' : 'Mong mu·ªën';
            const overValue = currentTotal > 100 ? currentTotal : desiredTotal;
            showToast(`‚ö†Ô∏è ${section.title}: T·ªïng ƒëi·ªÉm ${overType} = ${overValue} (v∆∞·ª£t qu√° 100). Vui l√≤ng ƒëi·ªÅu ch·ªânh l·∫°i.`, 'warning');
        } else {
            // Ki·ªÉm tra c√°c section kh√°c c√≥ v·∫•n ƒë·ªÅ kh√¥ng
            let hasOtherIssues = false;
            surveyData.forEach(otherSection => {
                if (otherSection.id !== sectionId) {
                    let otherCurrentTotal = 0;
                    let otherDesiredTotal = 0;
                    
                    otherSection.questions.forEach(question => {
                        const currentKey = `${otherSection.id}-${question.code}-current`;
                        const desiredKey = `${otherSection.id}-${question.code}-desired`;
                        otherCurrentTotal += responses[currentKey] || 0;
                        otherDesiredTotal += responses[desiredKey] || 0;
                    });
                    
                    if (otherCurrentTotal > 100 || otherDesiredTotal > 100) {
                        hasOtherIssues = true;
                        const overType = otherCurrentTotal > 100 ? 'Hi·ªán t·∫°i' : 'Mong mu·ªën';
                        const overValue = otherCurrentTotal > 100 ? otherCurrentTotal : otherDesiredTotal;
                        showToast(`‚ö†Ô∏è ${otherSection.title}: T·ªïng ƒëi·ªÉm ${overType} = ${overValue} (v∆∞·ª£t qu√° 100). Vui l√≤ng ƒëi·ªÅu ch·ªânh l·∫°i.`, 'warning');
                    }
                }
            });
            
            if (!hasOtherIssues) {
                hideToast();
            }
        }
    }

    // Th√™m v√†o cu·ªëi ph·∫ßn JavaScript
    function showToast(message, type = 'warning') {
        // X√≥a toast c≈© n·∫øu c√≥
        const existingToast = document.querySelector('.toast-notification');
        if (existingToast) {
            existingToast.remove();
        }
        
        const toast = document.createElement('div');
        toast.className = `toast-notification toast-${type}`;
        toast.innerHTML = `
            <span class="toast-close" onclick="this.parentElement.remove()">√ó</span>
            <div>${message}</div>
        `;
        
        document.body.appendChild(toast);
        
        // T·ª± ƒë·ªông ·∫©n sau 5 gi√¢y
        setTimeout(() => {
            if (toast.parentElement) {
                toast.remove();
            }
        }, 5000);
    }

    function hideToast() {
        const existingToast = document.querySelector('.toast-notification');
        if (existingToast) {
            existingToast.remove();
        }
    }
        </script>
    </body>
    </html>
